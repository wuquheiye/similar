<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Title</title>
    <link rel="stylesheet" href="../../bootstrop/css/bootstrap.css">
    <!--<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.2.0/css/bootstrap.min.css" />-->
    <!--<link rel="stylesheet" href="css/material.min.css" />-->
    <link rel="stylesheet" href="../css/bootstrap-material-datetimepicker.css" />
    <!--<link href='http://fonts.googleapis.com/css?family=Roboto:400,500' rel='stylesheet' type='text/css'>-->
    <link rel="stylesheet" type="text/css" href="../css/default.css">
    <!--jq-->
    <!--<script type="text/javascript" charset="utf-8" src="../jq/jquery-3.2.1.min.js"></script>-->
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!--bootstrap 样式-->
    <script type="text/javascript" charset="utf-8" src="../../bootstrop/js/bootstrap.js"></script>
    <script type="text/javascript" src="https://cdn.bootcss.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <!--日期控件-->
    <script type="text/javascript" src="../js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="../js/bootstrap-material-datetimepicker.js"></script>
    <!--    全局配置文件-->
    <script type="text/javascript" src="../../myjs/httpData.config.js"></script>
</head>
<style type="text/css">
    a {
        color: black;
        font-weight: Normal; /*CSS字体效果 普通 可以改成bold粗体 如果去除此行那么默认是不显示下划线的*/
        text-decoration: none;
    }

    a:hover {
        color: black;
        text-decoration: none;
        border-bottom: 1px #0099CC dotted
    }

    .list-group-item {
        border: 0px;
        text-align: center;
    }

    .list-group {
        margin-bottom: 0px;
    }

    .container {
        padding-left: 0px;
        padding-right: 0px;
    }

    .container-fluid {
        padding-left: 0px;
        padding-right: 0px;
    }

    .row {
        margin-left: 0px;
        margin-right: 0px;
        margin: 0px;
    }
    *{
        margin: 0px;
        padding: 0px;
    }

    .modal-dialog{
        margin: 0px;
    }
    .center{
        text-align: left;
    }



</style>

<body>
<div class="container-fluid">
    <!--头部-->
    <div class="container  navbar-fixed-top" style="background: white">
        <div class="row">
            <div class="col-xs-2">
                <a href="/use/index.html?publicBottomImages=publicBottomInformation"><h4><span class="glyphicon glyphicon-menu-left"
                                                                aria-hidden="true"></span></h4></a>
            </div>
            <div class="col-xs-8" style="text-align: center">
                <h4><b id="title">创建项目</b></h4></div>

        </div>
    </div>


    <!--新建项目-->
    <div class="container" style="padding-top: 35px;" id="newContent">
        <hr style="margin-top: 10px;margin-bottom: 10px;height:2px;width: 100%;background: #F4F4F4">
        <div class="row" style="height: 34px;">
            <div class="col-xs-4" style="height:34px;line-height: 34px;padding: 0px">项目名称</div>
            <div class="col-xs-8" style="line-height: 34px;padding-left: 0px">
                <input type="text" style="width: 100%;direction: rtl;border: 0px;outline:medium;" id="pname"
                       placeholder="请输入项目名称">
            </div>
        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <!--日期-->
        <div class="row" style="height: 34px;">
            <div class="col-xs-4" style="height:34px;line-height: 34px;padding: 0px">项目周期_开始</div>
            <div class="col-xs-8" style="line-height: 34px;padding-left: 0px">
                <input type="text" id="date" style="width: 100%;direction: rtl;border: 0px;outline:medium;" class="form-control floating-label" placeholder="Date">
            </div>
        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <div class="row" style="height: 34px;">
            <div class="col-xs-4" style="height:34px;line-height: 34px;padding: 0px">项目负责人</div>
            <div class="col-xs-8" style="line-height: 34px;padding-left: 0px">
                <div style="float: right;width: 40px;height: 34px;
                        line-height: 34px;background: #dbdbdb;
                        text-align: center;border-radius:20% 20% 20% 20%" id="projectName"></div>
            </div>
        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <div class="row" style="height: 34px;" data-target="#modal">
                <div class="col-xs-4" style="height:34px;line-height: 34px;padding: 0px">项目团队</div>
                <div class="col-xs-8" style="line-height: 34px;padding-left: 0px" id="team">
                </div>

        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <!--项目描述-->
        <div class="row" >
            <div class="col-xs-12" style="height:34px;line-height: 34px;padding: 0px">项目描述</div>
            <div class="col-xs-12" style="height: 130px;padding-left: 0px">
                <textarea class="form-control" style="height: 120px" id="upDescribe"></textarea>
            </div>
        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <div class="row" >
            <div class="col-xs-4" style="height:34px;line-height: 34px;padding: 0px">创建人</div>
            <div class="col-xs-8" style="line-height: 34px;padding-left: 0px">
                <div style="float: right;width: 40px;height: 34px;
                        line-height: 34px;background: #dbdbdb;
                        text-align: center;border-radius:20% 20% 20% 20%" id="creatName"></div>
            </div>
        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <div class="row" >
            <div class="col-xs-4" style="height:34px;line-height: 34px;padding: 0px">创建时间</div>
            <div class="col-xs-8" style="line-height: 34px;padding-left: 0px">
                <div style="float: right;width: 100px;height: 34px;
                        line-height: 34px;background: #dbdbdb;
                        text-align: center;border-radius:7% 7% 7% 7%;font-size: 6px" id="defaultTime" >

                </div>
            </div>
        </div>
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">
        <!--<div class="row" style="height: 500px">-->
        <!--<div class="col-xs-12">-->
        <!--发发发fsafafas-->
        <!--<a data-toggle="modal" href="./publicBottom.html" data-target="#modal" rel="noopener noreferrer">请点击我</a>-->
        <!--</div>-->

        <!--</div>-->
        <hr style="margin-top: 10px;margin-bottom: 10px;height: 5px;width: 100%;background: #F4F4F4">

    </div>


    <!--模态框-->
    <div class="modal" id="modal" style="width: 100%;height: 100%;padding: 0px">
        <div class="modal-dialog" style="width: 100%;height: 100%;">
            <div class="modal-content" style="width: 100%;height: 100%;"></div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal" onclick="close()">关闭</button>
            <button type="button" class="btn btn-primary" onclick="tijiao()">提交更改</button>
        </div>
    </div>

    <!--底部-->
    <div class="container navbar-fixed-bottom" style="padding-bottom: 25px">
        <button type="button" class="btn btn-primary btn-lg btn-block" onclick="createProject()">立即创建</button>
    </div>


</div>


</body>
<script>
    //缓存获取当前用户信息 , 并得到他的角色 loginObj.users.uid
    var loginObj = JSON.parse(window.sessionStorage.getItem("login"));
    // var uid=loginObj.users.uid;

    $("#creatName").text(loginObj.users.uusername);
    $("#projectName").text(loginObj.users.uusername);

    function tijiao() {
        let value=[];
        let valuekey=[]
        $(".getallname:checked").each(function (e) {
            value.push(this.value);
            valuekey.push($(this).attr('valuekey'));
        })
        alert(value);
        alert(valuekey);
        let showdata = '<button type="button" class="btn btn-primary"  id="but_'+1+'">'+value+'</button>';
        $("#team").html(showdata);
        $("#model").modal("hide");
    }

    //获取当前时间
    function getCurrentDate()
    {
        var timeStr = '-';
        var curDate = new Date();
        var curYear =curDate.getFullYear();  //获取完整的年份(4位,1970-????)
        var curMonth = curDate.getMonth()+1;  //获取当前月份(0-11,0代表1月)
        var curDay = curDate.getDate();       //获取当前日(1-31)
        var curWeekDay = curDate.getDay();    //获取当前星期X(0-6,0代表星期天)
        var curHour = curDate.getHours();      //获取当前小时数(0-23)
        var curMinute = curDate.getMinutes();   // 获取当前分钟数(0-59)
        var curSec =curDate.getSeconds();      //获取当前秒数(0-59)
        var Current= curYear+timeStr+curMonth+timeStr+curDay+" "+curHour+":"+curMinute;
        console.log(Current);
        // this.datetime=Current;
        return Current;
    }

    // 日期插件
    $(document).ready(function() {
        $('#date').bootstrapMaterialDatePicker
        ({
            time: false
        });

        $('#time').bootstrapMaterialDatePicker
        ({
            date: false,
            shortTime: true,
            format: 'HH:mm'
        });

        $('#date-format').bootstrapMaterialDatePicker
        ({
            format: 'dddd DD MMMM YYYY - HH:mm'
        });
        $('#date-fr').bootstrapMaterialDatePicker
        ({
            format: 'DD/MM/YYYY HH:mm',
            lang: 'fr',
            weekStart: 1,
            cancelText : 'ANNULER'
        });

        $('#date-end').bootstrapMaterialDatePicker
        ({
            weekStart: 0, format: 'DD/MM/YYYY HH:mm'
        });
        $('#date-start').bootstrapMaterialDatePicker
        ({
            weekStart: 0, format: 'DD/MM/YYYY HH:mm'
        }).on('change', function(e, date)
        {
            $('#date-end').bootstrapMaterialDatePicker('setMinDate', date);
        });

        $('#min-date').bootstrapMaterialDatePicker({ format : 'DD/MM/YYYY HH:mm', minDate : new Date() });

        // $.material.init()
    });



    $(function () {
        $("#defaultTime").text(getCurrentDate().split(" ")[0]);
    })

    function createProject() {
        let uid =loginObj.users.uid;
        let uusername = loginObj.users.uusername; //session获取
        let pname=$("#pname").val();
        let pstart_time = $("#date").val();
        let pteam = "1,2,3"; // 项目团队 成员id
        let upDescribe = $("#upDescribe").text();
        let defaultTime = $("#defaultTime").val();
        let data ={
            "project":{
                "uid" : uid,
                "pname" : pname,
                "pstartTime" : pstart_time,
                "pteam" : pteam,
                "uusername":uusername,
                "pdescribe" : upDescribe,
                "pcreatTime" : getCurrentDate()
            }
            // ,
            // "updateProject" :{
            //     // "upDescribe" : upDescribe,
            //     "upTime" : getCurrentDate()
            // }
        }
        $.ajax({
            url: pageDesignControl_HOST +"project/insertProject",
            type: "post",
            dataType: "json",
            data:JSON.stringify(data),
            contentType: 'application/json; charset=UTF-8',
            async: false,
            success: function(res) {
                if(res.msg!=0){
                    alert("创建成功");
                }else{
                    alert("进入数据库操作失败res="+res)
                }
            },
            error: function(){
                alert("网络异常，请重试");
            }
        });
    }



</script>
</html>