<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../bootstrop/css/bootstrap.css">
    <link rel="stylesheet" href="/use/css/index.css">
    <!--jq-->
    <script type="text/javascript" charset="utf-8" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!--bootstrap 样式-->
    <script type="text/javascript" charset="utf-8" src="../bootstrop/js/bootstrap.js"></script>
    <script type="text/javascript" charset="utf-8" src="../bootstrop/js/bootstrap.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../myjs/common.js"></script>
    <script type="text/javascript" charset="utf-8" src="../publicBottom/js/publicBottom.js"></script>
    <script type="text/javascript" charset="utf-8" src="../myjs/httpData.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="../myjs/index.js"></script>
    <script type="text/javascript" charset="utf-8" src="../myjs/public.js"></script>
    <script src="https://at.alicdn.com/t/font_1502544_rthj4rd15fl.js"></script>
    <!--    全局配置文件-->
    <script type="text/javascript" src="../myjs/httpData.config.js"></script>
</head><!-- 在头部引入bootstrap的css包与js包 -->
<style type="text/css">
    .modal-dialog {
        margin: 0px;
    }

    .modal {
        padding-left: 0px;
    }
</style>
<body>
<!-- 内容start -->

<div class="centerContain">
    <div class="publicBottomInformation hidden center">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 text-center" style="font-size:20px;height:40px;line-height:40px;">
                    功能
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12">
                    <div class="input-group">
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-default" aria-label="Left Align">
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div><!-- /btn-group -->
                        <input type="text" class="form-control" aria-label="..." placeholder="搜索">
                    </div><!-- /input-group -->
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <!--常用应用-->
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12" style="text-align: center;">
                    <ul class="list-group row">
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="createProject">
                            <a href="./create/createProject.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-danchuchuangjianxiangmu"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    创建项目
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="updateProject">
                            <a href="./updateManagement.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-gengxinxiangmujinzhan"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    更新项目
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="sealUse">
                            <a href="../flow/sealuseFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-yinzhangshiyongshenqing"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    印章使用申请
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="paymentApplication">
                            <a href="../flow/financePayFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-caiwufukuan"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    财务付款申请
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="businessReception">
                            <a href="../flow/serveFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-yewuzhaodai"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    业务招待申请
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="meetingNotice">
                            <a href="../flow/serveFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-huiyitongzhi"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    会议通知
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="writediary">
                            <a href="../daily/writeDaily.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-xierizhi"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    写日志
                                </div>
                            </a>
                        </li>


                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="leaveRequest">
                            <a href="../flow/leave.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-qingjiashenqing"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    请假申请
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="applicationOvertime">
                            <a href="../flow/overTimeFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-add-overtime"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    加班申请
                                </div>
                            </a>
                        </li>

                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="goOut">
                            <a href="../flow/gooutFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-waichushenqingxpx"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    外出申请
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="travelRequest">
                            <a href="../flow/onbusInessFlow.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-waichushenqing"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    出差申请
                                </div>
                            </a>
                        </li>

                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="profiling">
                            <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                <use xlink:href="#icon-caiwufukuan"></use>
                            </svg>
                            <div class="row" style="padding-top: 10px">
                                档案录入
                            </div>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="workAttendance">
                            <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                <use xlink:href="#icon-caiwufukuan"></use>
                            </svg>
                            <div class="row" style="padding-top: 10px">
                                考勤录入
                            </div>
                        </li>


                    </ul>

                </div>
            </div>
        </div>
        <!--<div class="container" style="background: #dbdbdb;height: 10px"></div>-->
    </div>
    <div class="publicBottomApply hidden center">
        <div class="container">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 text-center" style="font-size:20px;height:40px;line-height:40px;">
                        功能
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12" style="text-align: center;">
                    <ul class="list-group row">
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="applyCheck">
                            <a href="../flow/flowPath.html">
                                <img src="./image/流程管理.png" height="50px" width="50px">
                                <div class="row" style="padding-top: 10px">
                                    申请查看
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="viewProject">
                            <a href="projectManagement.html">
                                <img src="./image/项目管理.png" height="50px" width="50px">
                                <div class="row" style="padding-top: 10px">
                                    查看项目
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="viewLog">
                            <a href="../daily/daily.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-ziyuanxhdpi"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    查看日志
                                </div>
                            </a>
                        </li>

                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="CheckAttendance">
                            <a href="../checkingin/checkingin.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-ic_kaoqinbiao"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    考勤
                                </div>
                            </a>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="historicalApprovalRecord">
                            <a href="../message/chargeHistory.html">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                    <use xlink:href="#icon-xingzhuang"></use>
                                </svg>
                                <div class="row" style="padding-top: 10px">
                                    历史审批记录
                                </div>
                            </a>
                        </li>

                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="systemMessages">
                            <div style="position: relative">
                                <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;">
                                    <use xlink:href="#icon-ic_kaoqinbiao"></use>
                                </svg>
                                <span class="badge"
                                      style="display:none;position: absolute;top: 39px;margin-left: -15px;background: red"
                                      id="systemMessage"></span>
                            </div>
                            <div class="row" style="padding-top: 10px">
                                系统消息
                            </div>
                        </li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="backlogInformation">
                            <a href="../message/chargeMessage.html">
                                <div style="position: relative">
                                    <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;">
                                        <use xlink:href="#icon-xiaoxi-copy"></use>
                                    </svg>
                                    <span class="badge"
                                          style="display: none;position: absolute;top: 39px;margin-left: -15px;background: red"
                                          id="chargeMessage"></span>
                                </div>
                                <div class="row" style="padding-top: 10px">
                                    待办信息
                                </div>
                            </a></li>
                        <li class="list-group-item col-xs-3 hidden" style="border: 0px" id="staffLibrary">
                            <!--<a href="../checkingin/checkingin.html">-->
                            <svg class="icon" aria-hidden="true" style="width: 50px;height: 50px;color: #2aabd2">
                                <use xlink:href="#icon-tushuguan"></use>
                            </svg>
                            <div class="row" style="padding-top: 10px">
                                员工图书馆
                            </div>
                            <!--</a>-->
                        </li>

                    </ul>

                </div>
            </div>
        </div>
        <div class="container" style=" height: 40%;
                                      position: fixed;
                                      overflow-y:scroll; overflow-x: hidden;">
            <div class="row">


                <div class="col-xs-12" style="line-height: 40px ;">
                    <b>最近动态</b>
                </div>
            </div>
            <div class="row" style="position: relative">
                <div class="col-xs-12" id="pushServer" style="position: relative">

                </div>
            </div>
        </div>
    </div>
    <div class="publicBottomOrganization center hidden" style="padding-bottom:80px;">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 text-center" style="font-size:20px;height:40px;line-height:40px;">
                    通讯录
                </div>
            </div>
        </div>
        <div class="organizationContain">
            <div class="organizationCenter organizationHeaderOrganization">

                <!-- 查看被选中对象start -->
<!--                <div class="container containerTop">-->
<!--                    <div class="row">-->
<!--                        <div class="col-xs-3">-->
<!--                            <a href="javascript:history.back(-1)"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>取消</a>-->
<!--                        </div>-->
<!--                        <div class="col-xs-6 text-center">-->
<!--                            所有人-->
<!--                        </div>-->
<!--                        <div class="col-xs-3 text-center" onclick="clean()">-->
<!--                            清空-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="row" id="getname">-->
<!--                        <button type="button" class="btn btn-primary">已选中的人员</button>-->
<!--                    </div>-->
<!--                </div>-->
                <!-- 查看被选中对象end -->

                <!-- 组织列表 -->
                <ul id="organizationHeaderOrganizationUiContain">
                </ul>

                <!-- 查看被选中对象start -->
<!--                <button type="button" class="btn btn-primary col-xs-12 navbar-fixed-bottom-button" onclick="affirm()">确认</button>-->
                <!-- 查看被选中对象end -->
            </div>
        </div>
    </div>
    <div class="publicBottomMy center" style="padding-bottom:80px;">
        <div style="background-color: #0ab871;">
            <div class="text-center" style="height:44px;line-height:44px;font-size:20px;padding-top:10px;color:#ffffff">
                张三
            </div>
            <div class="text-center">
                <img src="../publicBottom/images/head.png" class="img-rounded" style="width:70px;padding-top:10px;">
            </div>
            <div class="text-center"
                 style="height:20px;line-height:20px;font-size:16px;margin-bottom:2px;color:#ffffff;margin-top:5px;">
                人事部经理
            </div>
            <div class="text-center"
                 style="height:20px;line-height:20px;font-size:14px;padding-bottom:45px;color:#ffffff">
                15274935036
            </div>
        </div>
        <div>
            <table class="table">
                <tbody style="font-size:16px;">
                <tr style="height:50px;line-height:50px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">姓名</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">张三</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-warning">修改</button>
                    </td>
                </tr>
                <tr style="height:35px;line-height:35px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">职位</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">经理</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-warning">修改</button>
                    </td>
                </tr>
                <tr style="height:35px;line-height:35px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">部门</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">人事部</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-warning">修改</button>
                    </td>
                </tr>
                <tr style="height:35px;line-height:35px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">电话号码</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">15274935036</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-success">修改</button>
                    </td>
                </tr>
                <tr style="height:35px;line-height:35px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">微信</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">15274935036</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-success">修改</button>
                    </td>
                </tr>
                <tr style="height:35px;line-height:35px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">QQ</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">2325805996</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-success">修改</button>
                    </td>
                </tr>
                <tr style="height:35px;line-height:35px;">
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">邮箱</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">2325805996QQ.com</td>
                    <td style="height:50px;line-height:50px;margin:0;padding:0;text-align:center;">
                        <button type="button" class="btn btn-success">修改</button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- 内容end -->

<div id="dibu" class="publicBottom">
    <nav class="navbar-fixed-bottom">
        <div class="container">
            <div class="row" style="background-color: #fff;padding-top:10px">
                <div class="publicBottomColXs5 col-xs-4 center"><img src="../publicBottom/images/functionBlack.png"
                                                                     class="publicBottomImages center-block"
                                                                     id="publicBottomInformation"/>
                    <div class="text-center">功能</div>
                </div>
                <div class="publicBottomColXs5 col-xs-4 center"><img src="../publicBottom/images/dynamicBlack.png"
                                                                     class="publicBottomImages center-block"
                                                                     id="publicBottomApply"/>
                    <div class="text-center">动态</div>
                </div>
                <div class="publicBottomColXs5 col-xs-4 center"><img src="../publicBottom/images/organizationBlack.png"
                                                                     class="publicBottomImages center-block"
                                                                     id="publicBottomOrganization"/>
                    <div class="text-center">通讯录</div>
                </div>
                <div class="publicBottomColXs5 col-xs-4 center"><img src="../publicBottom/images/myRed.png"
                                                                     class="publicBottomImages center-block"
                                                                     id="publicBottomMy"/>
                    <div class="text-center">我</div>
                </div>
            </div>
        </div>
    </nav>
</div>
<!-- bootstrap底部导航条end-->
</body>

</html>
<script>
    // var uid= 3;
    let status = window.location.href.split("=")[1];
    if (status == 1) {
        $(".centerContain .center").addClass("hidden");
        $(".publicBottomOrganization").removeClass("hidden");
        $("#dibu").hide();
        // $("publicBottomMy")
    }

    //缓存获取当前用户信息 , 并得到他的角色 loginObj.users.uid
    var loginObj = JSON.parse(window.sessionStorage.getItem("login"));

    var datashow = '';


    $(function () {
        selectProjectJournal()
        selectMessageNum()
    })

    //查询当前用户代办消息num
    function selectMessageNum() {
        $.ajax({
            url: pageDesignControl_HOST + "flow/selectMessageNum?uid="+loginObj.users.uid+"&rtype="+loginObj.role.rtype,
            type: "get",
            dataType: "json",
            contentType: 'application/json; charset=UTF-8',
            async: false,
            success: function(res) {
                if(typeof(res.msg)=='number'){
                    $("#chargeMessage").text(res.msg);
                    if($("#chargeMessage").text()!=0){
                        $("#chargeMessage").show();
                    }
                }
            },
            error: function(){
                alert("网络异常，请重试");
            }
        });
    }

    $("#chargeMessage").change(function () {
        alert($("#chargeMessage").text());
        if($("#chargeMessage").text()!=0){
            $("#chargeMessage").show();
        }
    })


    //查询所有项目和日志信息
    function selectProjectJournal() {
        let showdata='';
        $.ajax({
            url: pageDesignControl_HOST + "project/selectProjectJournal?uid="+loginObj.users.uid+"&rtype="+loginObj.role.rtype,
            type: "get",
            dataType: "json",
            contentType: 'application/json; charset=UTF-8',
            async: false,
            success: function(res) {
                if(res!=""){
                    $.each(res.msg,function (index,value) {
                        if(typeof(value.jid) == "number"){
                            showdata +='<a href="/journal/selectJournal/'+value.jid+'" style="color: black"><div class="row" style="position: relative">\n' +
                                '                        <div class="col-xs-12" style="margin: 5px;text-align: left">\n' +
                                '                            <b style="font-size: 16px;">'+value.uusername+'的日报</b>\n' +
                                '                        </div>\n' +
                                '                        <div class="col-xs-12" style="margin: 5px;text-align: left">\n' +
                                '                            日志详情:\n' + value.jnowTask+
                                '                        </div>\n' +
                                '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n'
                                +value.jcreateTime+
                                '                        </div>\n' +
                                '                    </div></a>';
                        }
                        else if(typeof (value.upId) == "number"){
                            showdata += '<a href="/project/selectUpByUpId/'+value.upId+'" style="color: black"><div class="row" style="position: relative">\n' +
                                '                        <div class="col-xs-12" style="margin: 5px;text-align: left">\n' +
                                '                            <b style="font-size: 16px;">'+value.pname+'+项目进度</b>\n' +
                                '                        </div>\n' +
                                '                        <div class="col-xs-12" style="margin: 5px">\n' +
                                '  <div class="progress-bar progress-bar-danger progress-bar-striped active" style="width:'+value.upProgress+'%">'+value.upProgress+'%</div>'+
                                '                        </div>\n' +
                                '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n' +
                                value.upTime
                            '                        </div>\n' +
                            '                    </div></a>';
                        }
                    })

                }
                $("#pushServer").html(showdata);
            },
            error: function(){
                alert("网络异常，请重试");
            }
        });
    }


    //模拟数据
    // let defultnum = 30;
    // setInterval(function(){
    //     let datashow='';
    //     let data = new Date();
    //     let yert = data.getFullYear();
    //     let mouth = data.getMonth()+1;
    //     let nowdata = data.getDate();
    //     let hour = data.getHours();
    //     let minute = data.getMinutes();
    //     let second = data.getSeconds();
    //     let one = analogInformation[0].one;
    //     let two =analogInformation[1].two;
    //
    //     if(second%2==1){
    //         datashow='<a href="../daily/dailyinfo.html" style="color: black"><div class="row" style="position: relative">\n' +
    //             '                        <div class="col-xs-12" style="margin: 5px">\n' +
    //             '                            <b style="font-size: 16px;">'+two.createProper+'的日报</b>\n' +
    //             '                        </div>\n' +
    //             '                        <div class="col-xs-12" style="margin: 5px">\n' +
    //             '                            日志详情:\n' + two.desc+
    //             '                        </div>\n' +
    //             '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n'
    //             +yert+'-'+mouth+'-'+nowdata+'  '+hour+':'+minute+':'+second+
    //             '                        </div>\n' +
    //             '                    </div></a>';
    //     }else{
    //         defultnum+=5;
    //         if(defultnum==100){
    //             defultnum=30;
    //         }
    //         datashow = '<a href="approval.html" style="color: black"><div class="row" style="position: relative">\n' +
    //             '                        <div class="col-xs-12" style="margin: 5px">\n' +
    //             '                            <b style="font-size: 16px;">'+one.projectName+'</b>\n' +
    //             '                        </div>\n' +
    //             '                        <div class="col-xs-12" style="margin: 5px">\n' +
    //             '  <div class="progress-bar progress-bar-danger progress-bar-striped active" style="width:'+defultnum+'%">'+defultnum+'%</div>'+
    //             '                        </div>\n' +
    //             '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n' +
    //              +yert+'-'+mouth+'-'+nowdata+' '+hour+':'+minute+':'+second+
    //             '                        </div>\n' +
    //             '                    </div></a>';
    //     }
    //
    //     $("#pushServer").prepend(datashow);
    // },1000);

    //websocket实时通讯
    var websocket = null;

    //判断当前浏览器是否支持WebSocket

    if ('WebSocket' in window) {
        let sid = "";
        sid = 'ws://localhost:43008/websocket/' + loginObj.users.uid;
        websocket = new WebSocket(sid);
        websocketthree = new WebSocket("ws://localhost:43008/websocket/0");
        websockettwo = new WebSocket("ws://localhost:43008/websocket/3");
    } else {

        alert('Not support websocket')

    }


    //连接发生错误的回调方法

    websocket.onerror = function () {

        setMessageInnerHTML("WebSocket连接发生错误");

    };
    websockettwo.onerror = function () {

        setMessageInnerHTML("WebSocket连接发生错误");

    };
    websocketthree.onerror = function () {

        setMessageInnerHTML("WebSocket连接发生错误");

    };


    //连接成功建立的回调方法
    websocket.onopen = function (event) {
        setMessageInnerHTML("WebSocket连接成功");
    }
    websockettwo.onopen = function (event) {
        setMessageInnerHTML("WebSocket连接成功");
    }
    websocketthree.onopen = function (event) {
        setMessageInnerHTML("WebSocket连接成功");
    }


    //接收到消息的回调方法

    websocket.onmessage = function (event) {
        console.log("转event前" + event);
        console.log("转event后" + JSON.stringify(event));
        // alert("进入socket")
        if (event.data != "连接成功") {
            getSocket(event.data);
        }

    }
    websocketthree.onmessage = function (event) {
        console.log("转event前" + event);
        console.log("转event后" + JSON.stringify(event));
        // alert("进入socket")
        if (event.data != "连接成功") {
            getSocket(event.data);
        }

    }
    websockettwo.onmessage = function (event) {
        console.log("转event前" + event);
        console.log("转event后" + JSON.stringify(event));
        // alert("进入socket")
        if (event.data != "连接成功") {
            if (parseInt($("#chargeMessage").text()) < 99 && parseInt($("#chargeMessage").text()) > 0) {
                let chargeMessageNum = parseInt($("#chargeMessage").text()) + 1;
                alert("代办信息" + chargeMessageNum);
                $("#chargeMessage").text(chargeMessageNum);

            } else {
                $("#chargeMessage").text(99);
            }

            // getSocket(event.data);
        }

    }


    //连接关闭的回调方法

    websocket.onclose = function () {

        setMessageInnerHTML("close");

    }
    websockettwo.onclose = function () {

        setMessageInnerHTML("close");

    }


    //监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。

    window.onbeforeunload = function () {

        websocket.close();
        websockettwo.close();

    }


    //将消息显示在网页上

    function getSocket(event) {
        // alert(JSON.stringify(event))
        console.log("转json前" + event);
        // console.log("获取updateProject"+event.updateProject);
        // // console.log("转json前获取upProgress"+event.updateProject.upProgress);
        // console.log("转json后"+JSON.stringify(event));
        // console.log("获取updateProject"+JSON.parse(event).updateProject);
        // console.log("转json后获取upProgress"+JSON.parse(event).updateProject.upProgress);
        //判斷接收的消息類型
        // alert("event.journal"+event.journal);
        if (JSON.parse(event).project != undefined) {
            if (JSON.parse(event).updateProject != undefined) {
                // alert("進入項目")
                datashow = '<a href="approval.html" style="color: black"><div class="row" style="position: relative">\n' +
                    '                        <div class="col-xs-12" style="margin: 5px">\n' +
                    '                            <b style="font-size: 16px;">' + JSON.parse(event).project.pname + '</b>\n' +
                    '                        </div>\n' +
                    '                        <div class="col-xs-12" style="margin: 5px">\n' +
                    '  <div class="progress-bar progress-bar-danger progress-bar-striped active" style="width:' + JSON.parse(event).updateProject.upProgress + '%">' + JSON.parse(event).updateProject.upProgress + '%</div>' +
                    '                        </div>\n' +
                    '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n' +
                    JSON.parse(event).updateProject.upTime
                '                        </div>\n' +
                '                    </div></a>';
            } else if (JSON.parse(event).updateProject == null) {
                datashow = '<a href="approval.html" style="color: black"><div class="row" style="position: relative">\n' +
                    '                        <div class="col-xs-12" style="margin: 5px">\n' +
                    '                            <b style="font-size: 16px;">' + JSON.parse(event).project.uusername + "创建了：" + JSON.parse(event).project.pname + '</b>\n' +
                    '                        </div>\n' +
                    '                        <div class="col-xs-12" style="margin: 5px">\n' +
                    '                            项目详情:\n' + JSON.parse(event).project.pdescribe +
                    '                        </div>\n' +
                    '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n' +
                    JSON.parse(event).project.pcreatTime
                '                        </div>\n' +
                '                    </div></a>';
            }

        } else if (JSON.parse(event).journal != undefined) {
            // alert("進入日誌")
            datashow = '<a href="../daily/dailyinfo.html" style="color: black"><div class="row" style="position: relative">\n' +
                '                        <div class="col-xs-12" style="margin: 5px">\n' +
                '                            <b style="font-size: 16px;">' + JSON.parse(event).users.uusername + '的日报</b>\n' +
                '                        </div>\n' +
                '                        <div class="col-xs-12" style="margin: 5px">\n' +
                '                            日志详情:\n' + JSON.parse(event).journal.jnowTask +
                '                        </div>\n' +
                '                        <div class="col-xs-12" style="text-align: right;color: gainsboro">\n'
                + JSON.parse(event).journal.jcreateTime +
                '                        </div>\n' +
                '                    </div></a>';
        }
        // alert(datashow);
        $("#pushServer").prepend(datashow);
    }


    function setMessageInnerHTML(innerHTML) {

        // document.getElementById('message').innerHTML += innerHTML + '<br/>';

    }


    //关闭连接

    function closeWebSocket() {

        websocket.close();

    }


    //发送消息

    function send() {

        var message = document.getElementById('text').value;

        websocket.send(message);

    }

</script>